---
title: "æœºå™¨å­¦ä¹ ç®—æ³•ç³»åˆ— - å†³ç­–æ ‘C4.5ç®—æ³•"
date: 2021-03-13 12:30:31 +0900
category: machine learning
tags: algorithm formula
toc: false
---

ä¸Šä¸€ç¯‡æ–‡ç« [æœºå™¨å­¦ä¹ ç®—æ³•ç³»åˆ— - å†³ç­–æ ‘ID3ç®—æ³•]({% post_url 2020-11-12-summary-of-machine-learning-algorithms-decision-tree-id3 %}), å¯¹å†³ç­–æ ‘ä¸­éå¸¸å…¸å‹çš„ ID3 ç®—æ³•åšäº†æ·±å…¥ä»‹ç». è¿™ç¯‡æ–‡ç« æœ¬æ¥ä¼šå¤§æ¦‚æ€»ç»“ä¸€ä¸‹ C4.5 ç®—æ³•. ä½†æ˜¯ç”±äº C4.5 ç®—æ³•ä¸ ID3 ç®—æ³•é«˜åº¦çš„ä¸€è‡´, æ‰€ä»¥è¿™é‡Œåªè°ˆåŠä¸€äº›å‰è€…ç›¸å¯¹äºåè€…çš„æ”¹è¿›.

# æå‡ºé—®é¢˜

ID3 ç®—æ³•çš„æ ¸å¿ƒåœ¨äºæ‰¾åˆ°ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾, åœ¨ä¸Šä¸€ç¯‡æ–‡ç« çš„ä¾‹å­å½“ä¸­, å°±èƒ½æ„Ÿè§‰åˆ°å…¶éå¸¸ç›´è§‚å’Œæ˜“äºç†è§£. ä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µä¸‹, å•æ˜¯ç»å¯¹çš„ä¿¡æ¯å¢ç›Šæ˜¯ä¸èƒ½å¤Ÿæ‰¾åˆ°çœŸæ­£æœ€æœ‰ç”¨çš„ç‰¹å¾çš„.

å‡è®¾è®­ç»ƒæ•°æ®é›†ä¸­æœ‰ä¸€åˆ— ID, æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ ID. é‚£ä¹ˆè¿™ä¸ª ID åˆ—çš„æ¡ä»¶ç†µä¼šå˜æˆ 0 (å› ä¸ºåœ¨ ID ç¡®å®šçš„æ¡ä»¶ä¸‹, å‡ºç°çš„ç±»åˆ«æ•°åªæœ‰ä¸€ä¸ª). ä½¿ç”¨è¿™ä¸ªå€¼ä¸º 0 çš„æ¡ä»¶ç†µå¾—åˆ°çš„ä¿¡æ¯å¢ç›Šå°±ä¼šéå¸¸å¤§ (ç­‰äºåŸæ¥çš„ä¿¡æ¯ç†µ). ä»ç°å®æ„ä¹‰ä¸Šçœ‹, è¿™ä¹Ÿæ˜¯ç¬¦åˆçš„. å› ä¸ºä¸€æ¡è®°å½•å¦‚æœç¡®å®šäº†å®ƒçš„ ID, é‚£ä¹ˆä»–çš„ç±»åˆ«ä¸€å®šä¹Ÿæ˜¯èƒ½è¢«ç¡®å®šçš„. åŸå› å°±æ˜¯ ID è¿™ä¸ªä¿¡æ¯é‡Œé¢åŒ…å«äº†å¤ªå¤šçš„ä¿¡æ¯é‡äº†. ä½†æ˜¯æ˜¾ç„¶ä¸èƒ½ä½¿ç”¨ ID ä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾. å®é™…ä¸Š, å¯¹äºæŸäº›ç‰¹å¾æ¥è¯´, å…¶æ¯ä¸ªå±æ€§æ‰€åŒ…å«çš„æ¯ä¸ªåˆ†ç±»ç±»åˆ«å¾ˆå¤šçš„æ—¶å€™, éƒ½ä¼šå¾—åˆ°å¾ˆå¤§ä¿¡æ¯å¢ç›Š. è¿™ä¸ªæ—¶å€™åªé€šè¿‡ä¿¡æ¯å¢ç›Šæ˜¯ä¸èƒ½é€‰å‡ºæœ‰æ•ˆçš„ç‰¹å¾çš„.

æ¦‚æ‹¬åœ°è¯´, å°±æ˜¯ä¸€ä¸ªç‰¹å¾å…¶ç‰¹å¾ç†µå¾ˆå¤§çš„æ—¶å€™ä¿¡æ¯å¢ç›Šå°±å¾ˆå¤§, åä¹‹å°±å¾ˆå°.

# è§£å†³æ–¹æ³•

ä¸ºäº†æ’é™¤ç‰¹å¾æœ¬èº«ä¿¡æ¯ç†µåœ°å¹²æ‰°, C4.5 ç®—æ³•é€‰æ‹©äº†ä¿¡æ¯å¢ç›Šç‡ (Gain Ratio) ä½œä¸ºé€‰æ‹©åˆ†æ”¯çš„å‡†åˆ™ã€‚å¯¹äºç‰¹å¾ç†µå¾ˆå¤§çš„ç‰¹å¾ï¼Œé™¤ä¸Šä¸€ä¸ªç›¸åº”çš„è¾ƒå¤§çš„æ•°å€¼ï¼Œåä¹‹ç‰¹å¾ç†µå°çš„ç‰¹å¾é™¤ä¸€ä¸ªè¾ƒå°çš„æ•°å€¼ï¼Œä½¿å¾—ç‰¹å¾çš„ä¿¡æ¯ç†µçš„å½±å“å˜å°ã€‚è¿™é‡Œ C4.5 ç®—æ³•ä¸­æ‰€é™¤ä»¥çš„æ•°å€¼ä½¿ç”¨äº†å±æ€§ç†µã€‚

$$
H_A(D) = -\sum\limits_{i=1}^{n}\frac{|D_i|}{|D|}\log\frac{|D_i|}{|D|}\notag
$$

å½“æ•°æ®é›† $D$ ä¸­ $A$ å±æ€§é‡Œæœ‰å¾ˆå¤šä¸åŒçš„å–å€¼æ—¶ï¼Œä¸Šè¿°çš„å±æ€§ç†µå°±ä¼šå˜å¾—å¾ˆå¤§ã€‚è¿™æ ·ç”±ä¿¡æ¯å¢ç›Šé™¤ä»¥è¯¥å€¼æ‰€å¾—åˆ°çš„å¢ç›Šç‡å°±èƒ½å¤Ÿæ­£çœŸåæ˜ å‡ºå±æ€§ $A$ ä½œä¸ºä¸€ä¸ªç‰¹å¾ï¼ŒåŒºåˆ†æ ·æœ¬çš„èƒ½åŠ›ã€‚**æœ€ç»ˆå°±é¿å…äº† ID3 è¶‹å‘ä¸é€‰æ‹©å–å€¼è¾ƒå¤šçš„å±æ€§ä½œä¸ºèŠ‚ç‚¹çš„é—®é¢˜**ã€‚

## æè¿°

1. ä»æ ¹èŠ‚ç‚¹å¼€å§‹, å¯¹èŠ‚ç‚¹è®¡ç®—æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾çš„ä¿¡æ¯å¢ç›Š;
2. é€‰æ‹©**ä¿¡æ¯å¢ç›Šæ¯”**æœ€å¤§çš„ç‰¹å¾ä½œä¸ºèŠ‚ç‚¹çš„ç‰¹å¾, æ„å»ºå­èŠ‚ç‚¹;
3. å¯¹å­èŠ‚ç‚¹é€’å½’è°ƒç”¨ä¸Šè¿°æ–¹æ³•, æ„å»ºå†³ç­–æ ‘;
4. ç›´åˆ°æ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šå‡å¾ˆå° (å¯ç”¨äº‹å‰å†³å®šçš„é˜ˆå€¼è¿›è¡Œåˆ¤æ–­) æˆ–è€…æ²¡æœ‰ç‰¹å¾å¯ä»¥é€‰æ‹©

## æ­¥éª¤

è¾“å…¥: è®­ç»ƒæ•°æ®é›† $D$, ç‰¹å¾é›† $A$, é˜ˆå€¼ $\epsilon$  
è¾“å‡º: å†³ç­–æ ‘ $T$  
æ­¥éª¤:  

1. è‹¥ $D$ ä¸­æ‰€æœ‰å®ä¾‹è¾“å…¥åŒä¸€ç±» $C_k$, åˆ™ $T$ ä¸ºå•èŠ‚ç‚¹æ ‘, å¹¶å°†ç±» $C_k$ ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°, è¿”å› $T$; (åªæœ‰ä¸€ä¸ªç±»çš„æƒ…å†µ)
2. è‹¥ $A=\varnothing$ , åˆ™ $T$ ä¸ºå•èŠ‚ç‚¹æ ‘, å¹¶å°† $D$ å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°, è¿”å› $T$; (æ²¡æœ‰ç‰¹å¾é‡çš„æƒ…å†µ)
3. å¦åˆ™, è®¡ç®— $A$ ä¸­å„ä¸ªç‰¹å¾å¯¹äº $D$ çš„**ä¿¡æ¯å¢ç›Šæ¯”**, é€‰æ‹©ä¿¡æ¯å¢ç›Šæ¯”æœ€å¤§çš„ç‰¹å¾ $A_g$;
4. å¦‚æœ $A_g$ çš„ä¿¡æ¯å¢ç›Šæ¯”å°äºé˜ˆå€¼ $\epsilon$, åˆ™ç½® $T$ ä¸ºå•èŠ‚ç‚¹æ ‘, å¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°, è¿”å› $T$; 
5. å¦åˆ™, å¯¹ $A_g$ çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ $a_i$, ä¾ $A_g = a_i$ å°† $D$ åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªéç©ºå­é›† $D_i$, å°† $D_i$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°, æ„å»ºå­èŠ‚ç‚¹, ç”±èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹æ„æˆæ ‘ $T$, è¿”å› $T$;
6. å¯¹äºç¬¬ $i$ ä¸ªå­èŠ‚ç‚¹, ä»¥ $D_i$ ä¸ºè®­ç»ƒé›†, ä»¥ $A-\{A_g\}$ ä¸ºç‰¹å¾é›†, é€’å½’è°ƒç”¨æ­¥1 ~ æ­¥5, å¾—åˆ°å­æ ‘ $T_i$, è¿”å› $T_i$.

å¯ä»¥çœ‹å‡º C4.5 ç®—æ³•å’Œ ID3 ç®—æ³•é™¤äº†ç‰¹å¾é€‰æ‹©çš„å‚ç…§ç‰©ä¸åŒä¹‹å¤–ï¼Œå…¶ä»–åŸºæœ¬ä¸Šæ˜¯ä¸€è‡´çš„ã€‚

# åŸºäº Python Scratch çš„å®ç°

å¯¹äºåŒä¸€ä¸ªé—®é¢˜[é¢„æµ‹èƒ½å¦è´·æ¬¾]({% post_url 2020-11-12-summary-of-machine-learning-algorithms-decision-tree-id3 %}#é—®é¢˜æå‡º)ï¼Œå’Œå‰æ–‡çš„ID3ä¸€æ ·ï¼Œè¿™é‡Œä¹Ÿç»™å‡º Python Scratch çš„å®ç°ã€‚ä»£ç ä¸ŠC4.5ç®—æ³•å’ŒID3ç®—æ³•ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯å¢åŠ äº†è®¡ç®—å±æ€§ç†µçš„éƒ¨åˆ†ï¼Œå¹¶ä¸”åŸæ¥å–å¾—æœ€å¤§ä¿¡æ¯å¢ç›Šçš„å‡½æ•°éœ€è¦æ”¹ä¸ºè®¡ç®—æœ€å¤§ä¿¡æ¯å¢ç›Šç‡çš„å‡½æ•°ã€‚

```python
def find_best_gain_ratio(X_train, y_train, features):
    h_d = calc_entropy(y_train)
    gr_max = 0
    feature_gr_max = 0
    for i in features:
        x_feature = X_train[:, i]
        ps = calc_probs(x_feature)
        Hs = [calc_entropy(y_train[x_feature == j]) for j in np.unique(x_feature)]
        h_da = sum(np.array(ps) * np.array(Hs))
        g = h_d - h_da
        # è®¡ç®—å±æ€§ç†µ
        h_ad = calc_entropy(x_feature)
        gr = g / h_ad
        if gr > gr_max:
            gr_max = gr
            feature_gr_max = i
    return gr_max, feature_gr_max
```

æœ€ç»ˆç‰ˆçš„ä»£ç åœ¨è¿™é‡Œ [Github](https://github.com/simcookies/algorithm_implement/blob/master/ml/Decision_Tree_C4.5_scratch.ipynb)ã€‚scikit-learn çš„å®ç°å’Œä¹‹å‰çš„ä¸€ç¯‡å®Œå…¨ä¸€æ ·ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å¦å¤–æ ¹æ® scikit-learn çš„å®˜æ–¹æ–‡æ¡£ï¼Œå†³ç­–æ ‘ä¸­é‡‡ç”¨çš„å¹¶ä¸æ˜¯ ID3/C4.5 ç®—æ³•ï¼Œè€Œæ˜¯ CARTã€‚ï¼ˆè¿™å°±å¾ˆå°´å°¬ğŸ˜…äº†ï¼Œä¸è¿‡çŸ¥é“ç®—æ³•çš„å®ç°ç»ˆå½’æ˜¯å¥½äº‹ã€‚ï¼‰

> scikit-learn uses an optimised version of the CART algorithm; however, scikit-learn implementation does not support categorical variables for now.

---

ä»¥ä¸Šå°±æ˜¯å…³äº C4.5 ç®—æ³•çš„è¯´æ˜ã€‚ä¹‹åç®—æ³•çš„å‘æ˜è€… Ross Quinlan å°†ç®—æ³•æ›´æ–°åˆ°äº† C5.0ï¼ˆæœ‰ä¸“åˆ©ä¿æŠ¤ï¼‰ï¼Œä½¿å¾—è®¡ç®—æ›´å¿«ï¼Œç»“æœæ›´ç²¾ç¡®ï¼Œä¸è¿‡è¿™å°±æ˜¯å¦å¤–çš„è¯äº†ã€‚